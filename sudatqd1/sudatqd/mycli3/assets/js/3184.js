"use strict";(self["webpackChunksudatqd"]=self["webpackChunksudatqd"]||[]).push([[3184],{3184:function(e,t,i){i.r(t),i.d(t,{default:function(){return h}});var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"background-color":"antiquewhite"}},[t("div",{staticStyle:{padding:"10px"}}),t("div",{attrs:{slot:"title"},slot:"title"}),t("span",{staticStyle:{"font-family":"'楷体'","font-size":"26px"}},[e._v("新增档案")]),t("el-tabs",{staticClass:"el-tab-div",staticStyle:{"font-family":"楷体","font-size":"26px",width:"80%","margin-left":"13%"}},[t("el-form",{ref:"addArchive",staticStyle:{"font-size":"32px !important"},attrs:{model:e.addArchive,rules:e.rules}},[t("el-form-item",{attrs:{label:"档案名称","label-width":e.formLabelWidth,prop:"archiveName"}},[t("el-input",{model:{value:e.addArchive.archiveName,callback:function(t){e.$set(e.addArchive,"archiveName",t)},expression:"addArchive.archiveName"}})],1),t("el-form-item",{staticStyle:{width:"630px"},attrs:{label:"档案图片","label-width":e.formLabelWidth}},[t("el-input",{staticStyle:{width:"388px"},attrs:{readonly:!0,placeholder:"文件名",clearable:""},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}}),t("el-upload",{ref:"upload",staticClass:"upload-demo",staticStyle:{float:"right"},attrs:{action:"doUpload",limit:1,"file-list":e.fileList,"before-upload":e.beforeFileUpload}},[t("el-button",{attrs:{slot:"trigger",type:"primary"},slot:"trigger"},[e._v("上传文件"),t("i",{staticClass:"el-icon-upload el-icon--right"})]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传1M以内的文件")])],1),t("img",{staticStyle:{float:"center","margin-top":"10px"},attrs:{src:e.addPaper.picture,width:"40%"}})],1),t("el-form-item",{attrs:{label:"档案编号","label-width":e.formLabelWidth,prop:"bianhao"}},[t("el-input",{model:{value:e.addArchive.bianhao,callback:function(t){e.$set(e.addArchive,"bianhao",t)},expression:"addArchive.bianhao"}})],1),t("el-form-item",{attrs:{label:"档案详情","label-width":e.formLabelWidth,prop:"archiveContent"}},[t("el-input",{attrs:{type:"textarea",rows:5,prop:"archiveContent"},model:{value:e.addArchive.archiveContent,callback:function(t){e.$set(e.addArchive,"archiveContent",t)},expression:"addArchive.archiveContent"}})],1),t("el-form-item",{attrs:{label:"所属机构","label-width":e.formLabelWidth,prop:"institutionId"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-select",{staticStyle:{width:"100%"},attrs:{props:e.institutionId,placeholder:"请选择",filterable:""},nativeOn:{click:function(t){return e.getCourses.apply(null,arguments)}},model:{value:e.addArchive.institutionId,callback:function(t){e.$set(e.addArchive,"institutionId",t)},expression:"addArchive.institutionId"}},e._l(e.institutions,(function(e){return t("el-option",{key:e.institutionId,attrs:{label:e.institutionName,value:e.institutionId}})})),1)]}}])}),t("el-form-item",{attrs:{label:"使用纸张","label-width":e.formLabelWidth,prop:"paperId"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-select",{staticStyle:{width:"100%"},attrs:{props:e.paperId,placeholder:"请选择",filterable:""},nativeOn:{click:function(t){return e.getPaper.apply(null,arguments)}},model:{value:e.addArchive.paperId,callback:function(t){e.$set(e.addArchive,"paperId",t)},expression:"addArchive.paperId"}},e._l(e.papers,(function(e){return t("el-option",{key:e.paperId,attrs:{label:e.paperName,value:e.paperId}})})),1)]}}])}),t("el-form-item",{attrs:{label:"纤维情况","label-width":e.formLabelWidth,prop:"degFiber"}},[t("el-input",{attrs:{prop:"degFiber"},model:{value:e.addArchive.degFiber,callback:function(t){e.$set(e.addArchive,"degFiber",t)},expression:"addArchive.degFiber"}})],1),t("el-form-item",{attrs:{label:"纤维老化情况","label-width":e.formLabelWidth,prop:"fiber"}},[t("el-input",{attrs:{prop:"fiber"},model:{value:e.addArchive.fiber,callback:function(t){e.$set(e.addArchive,"fiber",t)},expression:"addArchive.fiber"}})],1),t("el-form-item",{attrs:{label:"尺寸","label-width":e.formLabelWidth,prop:"size"}},[t("el-input",{attrs:{prop:"size"},model:{value:e.addArchive.size,callback:function(t){e.$set(e.addArchive,"size",t)},expression:"addArchive.size"}})],1),t("el-form-item",{attrs:{label:"厚度","label-width":e.formLabelWidth,prop:"thickness"}},[t("el-input",{attrs:{prop:"thickness"},model:{value:e.addArchive.thickness,callback:function(t){e.$set(e.addArchive,"thickness",t)},expression:"addArchive.thickness"}})],1),t("el-form-item",{attrs:{label:"白度","label-width":e.formLabelWidth,prop:"whiteness"}},[t("el-input",{attrs:{prop:"whiteness"},model:{value:e.addArchive.whiteness,callback:function(t){e.$set(e.addArchive,"whiteness",t)},expression:"addArchive.whiteness"}})],1),t("el-form-item",{attrs:{label:"形制","label-width":e.formLabelWidth,prop:"form"}},[t("el-input",{attrs:{prop:"form"},model:{value:e.addArchive.form,callback:function(t){e.$set(e.addArchive,"form",t)},expression:"addArchive.form"}})],1),t("el-form-item",{attrs:{label:"打浆度","label-width":e.formLabelWidth,prop:"beatDeg"}},[t("el-input",{attrs:{prop:"beatDeg"},model:{value:e.addArchive.beatDeg,callback:function(t){e.$set(e.addArchive,"beatDeg",t)},expression:"addArchive.beatDeg"}})],1),t("el-form-item",{attrs:{label:"帘纹","label-width":e.formLabelWidth,prop:"lianwen"}},[t("el-input",{attrs:{prop:"lianwen"},model:{value:e.addArchive.lianwen,callback:function(t){e.$set(e.addArchive,"lianwen",t)},expression:"addArchive.lianwen"}})],1),t("el-form-item",{attrs:{label:"染色材料","label-width":e.formLabelWidth,prop:"color"}},[t("el-input",{attrs:{prop:"color"},model:{value:e.addArchive.color,callback:function(t){e.$set(e.addArchive,"color",t)},expression:"addArchive.color"}})],1),t("el-form-item",{attrs:{label:"添加成分","label-width":e.formLabelWidth,prop:"composition"}},[t("el-input",{attrs:{prop:"composition"},model:{value:e.addArchive.composition,callback:function(t){e.$set(e.addArchive,"composition",t)},expression:"addArchive.composition"}})],1),t("el-form-item",{attrs:{label:"责任者","label-width":e.formLabelWidth,prop:"author"}},[t("el-input",{model:{value:e.addArchive.author,callback:function(t){e.$set(e.addArchive,"author",t)},expression:"addArchive.author"}})],1),t("el-form-item",{staticStyle:{"margin-left":"1px",width:"300px"},attrs:{label:"档案出现时间","label-width":e.formLabelWidth,prop:"firstTime"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",align:"right","picker-options":e.pickerOptions},model:{value:e.addArchive.firstTime,callback:function(t){e.$set(e.addArchive,"firstTime",t)},expression:"addArchive.firstTime"}})],1),t("el-form-item",{staticStyle:{"margin-left":"1px",width:"300px"},attrs:{label:"档案采集时间","label-width":e.formLabelWidth,prop:"recordTime"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",align:"right","picker-options":e.pickerOptions},model:{value:e.addArchive.recordTime,callback:function(t){e.$set(e.addArchive,"recordTime",t)},expression:"addArchive.recordTime"}})],1)],1),t("div",{staticClass:"dialog-footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addarchive()}}},[e._v("提 交")]),t("el-button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("取 消")])],1)],1)],1)},a=[],s=(i(44114),i(68016),i(69053),i(77819),i(30558)),l=i(60250),o=i(76678),d={components:{WangEditor:WangEditor},data(){return{rules:{archiveName:[{required:!0,message:"请输入档案名称",trigger:"blur"}],archiveContent:[{required:!0,message:"请输入档案介绍",trigger:"blur"}],bianhao:[{required:!0,message:"请输入档案编号",trigger:"blur"}],paperId:[{required:!0,message:"请选择纸张",trigger:"blur"}],institutionId:[{required:!0,message:"请选择机构",trigger:"blur"}],fileName:[{required:!0,message:"请上传图片",trigger:"blur"}],fiber:[{required:!0,message:"请输入纤维老化情况",trigger:"blur"}],size:[{required:!0,message:"请输入尺寸",trigger:"blur"}],form:[{required:!0,message:"请输入形制",trigger:"blur"}],thickness:[{required:!0,message:"请输入厚度",trigger:"blur"}],whiteness:[{required:!0,message:"请输入白度",trigger:"blur"}],beatDeg:[{required:!0,message:"请输入打浆度",trigger:"blur"}],lianwen:[{required:!0,message:"请输入帘纹",trigger:"blur"}],color:[{required:!0,message:"请输入染色材料",trigger:"blur"}],composition:[{required:!0,message:"请输入成分",trigger:"blur"}],author:[{required:!0,message:"请输入责任者",trigger:"blur"}],firstTime:[{required:!0,message:"请输入出现时间",trigger:"blur"}],recordTime:[{required:!0,message:"请输入记录时间",trigger:"blur"}]},activeName1:"1",activeName:"1",users:[],options:[],datefilter:new Date(1912,0,1,0,0),datefilter1:new Date(1949,9,1,0,0),value:[],list:[],loading:!1,isShow:!0,dialogVisible7:!1,adVisible7:!1,dialogVisible9:!1,adVisible9:!1,dialogVisible8:!1,adVisible8:!1,smid:"",currentPage:1,pageSizes:[2,5,10,20,30,50],pageSize:10,total:"",total1:"",total2:"",total5:"",selectName:[],selectName7:[],query:"",order:0,addArchive:[],fileName:"",fileName1:"",file:null,dialogVisible5:!1,adVisible5:!1,total4:"",typeName:{0:"手工纸",1:"机械纸",2:"半手工半机械纸"},typelist1:[{paperType:0,typeName:"手工纸"},{paperType:1,typeName:"机械纸"},{paperType:2,typeName:"半手工半机械纸"}],fileList:[],fileList1:[],dialogVisible:!1,adVisible:!1,dialogVisible1:!1,adVisible1:!1,dialogVisible2:!1,adVisible2:!1,formLabelWidth:"120px",firstTime:"",addPaper:{paperName:"",paperDes:"",paperType:"",paperId:"",site:"",location:"",process:"",picture:"",firstTime:""},institutions:[],papers:[],typelist1:[{paperType:0,typeName:"手工纸"},{paperType:1,typeName:"机械纸"},{paperType:2,typeName:"半手工半机械纸"}],typeName:{0:"手工纸",1:"机械纸",2:"半手工半机械纸"},pickerOptions:{shortcuts:[{text:"今天",onClick(e){e.$emit("pick",new Date)}},{text:"昨天",onClick(e){const t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick(e){const t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]}}},created(){this.getCourses(),this.getPaper()},computed:{},methods:{filterTag(e,t,i){const r=i["property"];return t[r]===e},_filterChange(){this.totalSize=this.$refs.table.projectList.length,console.log(this.totalSize)},sendWangEditor(e){this.oneProjects.hyperlinks=e},getCourses(){(0,s.E7)().then((e=>{this.institutions=e.data,console.log(this.institutions)}))},getPaper(){(0,l.L2)().then((e=>{this.papers=e.data,console.log(this.papers)}))},reload(){this.isShow=!1,this.$nextTick((()=>{this.isShow=!0,this.$refs.table.bodyWrapper.scrollTop=0}))},remoteMethod(e){""!==e?(this.loading=!0,SelectProject(e).then((e=>{this.projectList=e.data})),setTimeout((()=>{this.loading=!1,this.options=this.listSet.filter((t=>t.label.toLowerCase().indexOf(e.toLowerCase())>-1))}),1e3)):this.options=[]},back(){this.$router.push("/introduction/index")},selectList1(){Projects().then((e=>{this.selectName=e.data}))},resetQuery(){this.query="",this.currentPage=1,this.pageSize=10,this.typefilter="",this.coursefilter="",this.getProjects()},indexMethods(e){return(this.currentPage-1)*this.pageSize+e+1},beforeFileUpload(e){const t=e.size/1024/1024<1;return t?(this.file=e,this.fileName=e.name,!1):(this.$message.error("上传的文件大小不能超过 1MB!"),!1)},addarchive(){if(console.log(this.addArchive),""==this.addArchive.archiveName)return this.$message({type:"warning",message:"纸张名称为空，请填写！"}),!1;this.$refs.addArchive.validate((e=>{if(!e)return console.log("error submit!!"),!1;this.$confirm("您确定要提交该档案吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=new FormData;e.append("file",this.file),e.append("paperId",this.addArchive.paperId),e.append("archiveName",this.addArchive.archiveName),e.append("author",this.addArchive.author),e.append("institutionId",this.addArchive.institutionId),e.append("archiveContent",this.addArchive.archiveContent),e.append("size",this.addArchive.size),e.append("thickness",this.addArchive.thickness),e.append("whiteness",this.addArchive.whiteness),e.append("composition",this.addArchive.composition),e.append("form",this.addArchive.form),e.append("archiveStateType",this.addArchive.archiveStateType),e.append("beatDeg",this.addArchive.beatDeg),e.append("fiber",this.addArchive.fiber),e.append("degFiber",this.addArchive.degFiber),e.append("bianhao",this.addArchive.bianhao),e.append("color",this.addArchive.color),e.append("lianwen",this.addArchive.lianwen),e.append("firstTime",new Date(this.addArchive.firstTime)),e.append("recordTime",new Date(this.addArchive.recordTime)),(0,o.HH)(e).then((e=>{"操作成功"==e.message?(this.$router.push("/introduction/index"),this.$message({type:"success",message:"添加成功！"}),this.adVisible=!1,this.$router.push("/introduction/index")):"暂无权限"==e.message?(this.$message({type:"error",message:"暂无编辑权限！"}),this.adVisible=!1):500==e.code?(this.$message({type:"error",message:"档案名重复！"}),this.adVisible=!1):this.$message({type:"error",message:e.message})}))}))}))},indexMethods4(e){return(this.currentPage4-1)*this.pageSize4+e+1}},filters:{formatData(e){return moment(e).format("YYYY-MM-DD")}}},n=d,p=i(81656),c=(0,p.A)(n,r,a,!1,null,"0bc87b4b",null),h=c.exports},68016:function(e,t,i){var r=i(85471);r["default"].filter("filterAmount",(function(e,t){return t||(t=20),e&&e.length>t&&(e=e.substring(0,t)+"..."),e}))}}]);