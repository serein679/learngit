"use strict";(self["webpackChunksudatqd"]=self["webpackChunksudatqd"]||[]).push([[2794],{82794:function(e,t,i){i.r(t),i.d(t,{default:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",{attrs:{slot:"title"},slot:"title"},[t("div",{staticStyle:{padding:"10px"}},[t("el-breadcrumb",{attrs:{separator:"/"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/management/cooperationManagement"}}},[e._v("大事记详情管理")]),t("el-breadcrumb-item",{attrs:{to:{path:"/management/editorAchv"}}},[e._v("编辑大事记")])],1)],1),t("span",{staticStyle:{"font-family":"'楷体'","font-size":"26px"}},[e._v("编辑大事记")]),t("el-tabs",{staticClass:"el-tab-div",staticStyle:{"font-family":"楷体","font-size":"26px"}},[t("el-form",{ref:"oneHis",staticStyle:{"font-size":"32px !important"},attrs:{model:e.oneHis,rules:e.rules}},[t("el-form-item",{attrs:{label:"事记名称","label-width":e.formLabelWidth,prop:"eventName"}},[t("el-input",{model:{value:e.oneHis.eventName,callback:function(t){e.$set(e.oneHis,"eventName",t)},expression:"oneHis.eventName"}})],1),t("el-form-item",{staticStyle:{width:"630px"},attrs:{label:"事记图片","label-width":e.formLabelWidth}},[t("el-input",{staticStyle:{width:"388px"},attrs:{readonly:!0,placeholder:"文件名",clearable:""},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}}),t("el-upload",{ref:"upload",staticClass:"upload-demo",staticStyle:{float:"right"},attrs:{action:"doUpload",limit:1,"file-list":e.fileList,"before-upload":e.beforeFileUpload}},[t("el-button",{attrs:{slot:"trigger",type:"primary"},slot:"trigger"},[e._v("上传文件"),t("i",{staticClass:"el-icon-upload el-icon--right"})]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传1M以内的文件")])],1),t("img",{staticStyle:{float:"center","margin-top":"10px"},attrs:{src:e.oneHis.eventPic,width:"40%"}})],1),t("el-form-item",{staticStyle:{"margin-left":"1px",width:"300px"},attrs:{label:"大事记时间","label-width":e.formLabelWidth,prop:"eventDate"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",align:"right","picker-options":e.pickerOptions},model:{value:e.oneHis.eventDate,callback:function(t){e.$set(e.oneHis,"eventDate",t)},expression:"oneHis.eventDate"}})],1),t("el-form-item",{staticStyle:{height:"1200px"},attrs:{label:"事记详情","label-width":e.formLabelWidth,prop:"eventDescription"}},[t("WangEditor",{attrs:{editorData:e.editor},on:{sendWangEditor:e.changeOutline}})],1)],1),t("div",{staticClass:"dialog-footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.changeEvent()}}},[e._v("修 改")]),t("el-button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("取 消")])],1)],1)],1)},s=[],r=(i(44114),i(53019),i(60250),i(78896)),n={components:{},data(){return{rules:{eventName:[{required:!0,message:"请输入事记名称",trigger:"blur"}],eventDescription:[{required:!0,message:"请输入事记详情",trigger:"blur"}],process:[{required:!0,message:"请输入制作流程",trigger:"blur"}],site:[{required:!0,message:"请输入地点",trigger:"blur"}],paperType:[{required:!0,message:"请选择纸张类型",trigger:"blur"}],fileName:[{required:!0,message:"请上传图片",trigger:"blur"}],institutionDescription:[{required:!0,message:"请输入机构描述",trigger:"blur"}],eventDate:[{required:!0,message:"请输入事记出现时间",trigger:"blur"}]},activeName1:"1",activeName:"1",users:[],paperId:"",options:[],value:[],list:[],loading:!1,isShow:!0,dialogVisible7:!1,adVisible7:!1,dialogVisible9:!1,adVisible9:!1,dialogVisible8:!1,adVisible8:!1,teachers:[],smid:"",paperList:[],oneInstitution:[],teachers:[],currentPage:1,pageSizes:[2,5,10,20,30,50],pageSize:10,total:"",total1:"",total2:"",total5:"",selectName:[],selectName7:[],query:"",order:0,oneHis:[],editor:"",fileName:"",fileName1:"",file:null,dialogVisible5:!1,adVisible5:!1,total4:"",typeName:{0:"手工纸",1:"机械纸",2:"半手工半机械纸"},fileList:[],fileList1:[],headers:{},dialogVisible:!1,adVisible:!1,dialogVisible1:!1,adVisible1:!1,dialogVisible2:!1,adVisible2:!1,formLabelWidth:"120px",typelist1:[{paperType:0,typeName:"手工纸"},{paperType:1,typeName:"机械纸"},{paperType:2,typeName:"半手工半机械纸"}],pickerOptions:{shortcuts:[{text:"今天",onClick(e){e.$emit("pick",new Date)}},{text:"昨天",onClick(e){const t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick(e){const t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]}}},created(){this.gettingData(),this.getOneHistoricalEvent(this.eventId)},watch:{$route:"gettingData"},methods:{getTeacherIntro(){TeacherIntro().then((e=>{this.teachers=e.data}))},filterTag(e,t,i){const a=i["property"];return t[a]===e},gettingData(){var e=JSON.parse(this.$Base64.decode(this.$route.query.info));this.eventId=e},_filterChange(){this.totalSize=this.$refs.table.projectList.length,console.log(this.totalSize)},sendWangEditor(e){this.oneProjects.hyperlinks=e},indexMethods(e){return(this.currentPage-1)*this.pageSize+e+1},changeOutline(e){this.oneHis.eventDescription=e},beforeFileUpload(e){const t=e.size/1024/1024<10;return t?(this.file=e,this.fileName=e.name,!1):(this.$message.error("上传的文件大小不能超过 10MB!"),!1)},getOneHistoricalEvent(e){(0,r.rm)(e).then((e=>{this.oneHis=e.data[0],this.editor=this.oneHis.eventDescription,this.fileName=this.oneHis.eventPic,console.log(this.oneHis)}))},changeEvent(){if(console.log(this.oneHis),""==this.oneHis.eventName)return this.$message({type:"warning",message:"事件名称为空，请填写！"}),!1;this.$refs.oneHis.validate((e=>{if(!e)return console.log("error submit!!"),!1;this.$confirm("您确定要修改该事件吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=new FormData;e.append("file",this.file),e.append("eventId",this.oneHis.eventId),e.append("eventName",this.oneHis.eventName),e.append("eventDescription",this.oneHis.eventDescription),e.append("eventDate",new Date(this.oneHis.eventDate)),e.append("eventPic",this.oneHis.eventPic),(0,r.ju)(e).then((e=>{"操作成功"==e.message?(this.$router.push("/management/cooperationManagement"),this.$message({type:"success",message:"修改成功！"}),this.dialogVisible=!1):"暂无权限"==e.message?(this.$message({type:"error",message:"暂无编辑权限！"}),this.dialogVisible=!1):this.$message({type:"error",message:e.message})}))}))}))},back(){this.$router.push("/management/cooperationManagement")},indexMethods4(e){return(this.currentPage4-1)*this.pageSize4+e+1}},filters:{formatData(e){return moment(e).format("YYYY-MM-DD")}}},l=n,o=i(81656),p=(0,o.A)(l,a,s,!1,null,"0ddb77a5",null),c=p.exports},53019:function(e,t,i){var a=i(85471);a["default"].filter("filterAmount",(function(e,t){return t||(t=20),e&&e.length>t&&(e=e.substring(0,t)+"..."),e}))}}]);